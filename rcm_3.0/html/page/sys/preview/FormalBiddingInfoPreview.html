<link href="../styles/style.css" rel="stylesheet" type="text/css"/>
<div class="mcontainer-fluid" ng-controller="FormalBiddingInfoPreview">
    <div class="mheader row">
        <div class="col-md-10 col-sm-10 col-xs-10">
            <h3 class="text-blue">{{ formalPreview.apply.projectName }}</h3>
            <h5 class="text-gray">评审报告出具时间：{{formalPreview.submit_date}}</h5>
        </div>
        <a href="#/FormalBiddingInfo/{{formalPreview.id}}@2/{{formalPreview.url}}/1">返回</a>
        <img src="assets/images/pixel-admin/main-navbar-logo.png" alt="Pixel Admin" class="logo" />
    </div>
    <div class="row mtab2 text-gray">
        <a id="processReview" class="chose col-md-3 col-sm-6 col-xs-12">
            项目过程回顾
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="template" class="col-md-3 col-sm-6 col-xs-12">
            风控评审意见汇总
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="formalReport" class="col-md-3 col-sm-6 col-xs-12">
            正式评审报告
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="score" class="col-md-3 col-sm-6 col-xs-12">
            项目整体评分
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
    </div>
    <!--<div class="row mtab text-gray">
        <a id="processReview" class="chose col-md-3 col-sm-6 col-xs-12">项目过程回顾</a>
        <a id="template" class="col-md-3 col-sm-6 col-xs-12">风控评测意见汇总</a>
        <a id="formalReport" class="col-md-3 col-sm-6 col-xs-12">正式评审报告</a>
        <a id="score" class="col-md-3 col-sm-6 col-xs-12">项目整体评分</a>
    </div>-->
    <div class="mperson row">
        <div class="col-md-3 col-sm-6 col-xs-12">评审负责人<em>{{formalPreview.taskallocation.reviewLeader.NAME}}</em></div>
        <div class="col-md-3 col-sm-6 col-xs-12">法律负责人<em>{{formalPreview.taskallocation.legalReviewLeader.NAME}}</em></div>
        <div class="col-md-3 col-sm-6 col-xs-12">投资建议<em>{{formalPreview.investmentType.ITEM_NAME}}</em></div>
        <div class="col-md-3 col-sm-6 col-xs-12">评审难度评级<em>{{ formalPreview.projectRating.name }}</em></div>
    </div>
    <div class="row rowsection out-rowsection">
        <div class="outside-swiper swiper-container">
            <div class="swiper-button-prev out-swiper-button-prev"></div>
            <div class="swiper-button-next out-swiper-button-next"></div>
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div ng-include src="'page/sys/preview/tabPage/processReview.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/sys/preview/tabPage/template.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/sys/preview/tabPage/formalReport.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/sys/preview/tabPage/score.html'"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function() {
        setTimeout(function () {
            var outsideSwiper = new Swiper('.outside-swiper', {
                observer: true,
                observeParents: true,
                loop: false,
                autoHeight: true,
                roundLengrhs: true,
                navigation: {
                    nextEl: '.out-swiper-button-next',
                    prevEl: '.out-swiper-button-prev'
                },
                on: {
                    slideChange: function(){
                        if(this.activeIndex == 1){
                            $('.out-swiper-button-prev').hide()
                            $('.out-swiper-button-next').hide()
                        }else{
                            $('.out-swiper-button-prev').show()
                            $('.out-swiper-button-next').show()
                        }
                    },
                    transitionStart: function () {
                        var formalBiddingInfoPreview = document.querySelector('[ng-controller = FormalBiddingInfoPreview]');
                        var $scope = angular.element(formalBiddingInfoPreview).scope();
                        $scope.changeStyle(this.activeIndex)
                    }
                }
            });
            $('#processReview').click(function(){
                outsideSwiper.slideTo(0, 1000, true);//切换到第一个slide，速度为1秒
            });
            $('#template').click(function(){
                outsideSwiper.slideTo(1, 1000, true);//切换到第二个slide，速度为1秒
            });
            $('#formalReport').click(function(){
                outsideSwiper.slideTo(2, 1000, true);//切换到第三个slide，速度为1秒
            });
            $('#score').click(function(){
                outsideSwiper.slideTo(3, 1000, true);//切换到第四个slide，速度为1秒
            });
            $('.swiper-slide').dblclick(function (e) {
                e.stopPropagation()
                alert('双击');
                if($('.out-rowsection').hasClass('wrap')){
                    $('.out-rowsection').removeClass('wrap')
                    $('.outside-swiper').removeClass('current-swiper-scale')
                    $('.mcontent').removeClass('mcontent2')
                    $('.left-swiper').show()
                    $('.right-swiper').show()
                    outsideSwiper = new Swiper('.outside-swiper',{
                        loop:false,
                        navigation:{
                            nextEl:'.swiper-button-next',
                            prevEl:'.swiper-button-prev'
                        },
                    })
                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                }else{
                    $('.out-rowsection').addClass('wrap')
                    $('.outside-swiper').addClass('current-swiper-scale')
                    $('.mcontent').addClass('mcontent2')
                    $('.left-swiper').hide()
                    $('.right-swiper').hide()
                    outsideSwiper = new Swiper('.outside-swiper',{
                        loop:false,
                        navigation:{
                            nextEl:'.swiper-button-next',
                            prevEl:'.swiper-button-prev'
                        },
                    })
                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                }
            })

            function toeven(num){
                return num%2 == 0?num:num+1
            }
            $('.text-blue').click(function (e) {
                e.stopPropagation()
                if($('.out-rowsection').hasClass('wrap')){
                    $('.out-rowsection').removeClass('wrap')
                    $('.outside-swiper').removeClass('current-swiper-scale')
                    $('.mcontent').removeClass('mcontent2')
                    $('.left-swiper').show()
                    $('.right-swiper').show()
                    //$('.current-swiper')
                    outsideSwiper = new Swiper('.outside-swiper',{
                        loop:false,
                        navigation:{
                            nextEl:'.swiper-button-next',
                            prevEl:'.swiper-button-prev'
                        },
                    })
                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                }else{
                    $('.out-rowsection').addClass('wrap')
                    $('.outside-swiper').addClass('current-swiper-scale')
                    $('.mcontent').addClass('mcontent2')
                    $('.left-swiper').hide()
                    $('.right-swiper').hide()
                    outsideSwiper = new Swiper('.outside-swiper',{
                        loop:false,
                        navigation:{
                            nextEl:'.swiper-button-next',
                            prevEl:'.swiper-button-prev'
                        },
                    })
                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })

                }
            })
        }, 1000);
    })
</script>