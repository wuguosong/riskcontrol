<div class="panel-body">
    <!--form表单开始-->
    <form class="form-horizontal" name="myFormPre" id="myFormPre"   novalidate>
        <div class="">
            <div class="header detail-page">
                <img src="assets/images/icons/detail.png" width="" height="" alt="" title="" /><span class="hd-title">{{title}}</span>
            </div>
            <div class="panel">
                <div class="panel-heading"><div class="panel-hd-cont"><span class="panel-title">{{title}}<i class="i-triangle"></i></span></div></div>
                <div class="panel-body">
                    <div id="myTab" class="myTab">
                        <ul class="nav nav-tabs bs-tabdrop-example">
                            <li class="active">
                                <a href="/#contracts_file_info" data-toggle="tab">流程表单</a>
                            </li>
                            <!--<li>
                                <a href="/#flow_chart" data-toggle="tab">流程图</a>
                            </li>-->
                            <li>
                                <a href="/#flow_chart" data-toggle="tab" ng-if="flag != '1'">流程图</a>
                            </li>
                            <li >
                                <a href="/#contracts_resources" data-toggle="tab" ng-if="flag != '1'">相关资源</a>
                            </li>
                        </ul>
                    </div>
                    <div class="tab-content tab-content-bordered">
                        <div class="tab-pane in active" id="contracts_file_info">
                            <div class="row">
                                <label class="col-sm-2 control-label">所属大区</label>
                                <div class="col-sm-4 has-feedback reporting-unit">
                                    <div class="full-drop">
                                        <input type="text" class="form-control" data-toggle="modal" data-target="#myModal" id="pertainArea" name="pertainArea" ng-model="pre.apply.pertainArea.VALUE" readonly/>
                                        <input type="hidden" class="form-control" id="pertainAreaKey" name="pertainAreaKey" ng-model="pre.apply.pertainArea.KEY" readonly/>
                                    </div>
                                </div>
                                <label class="col-sm-2 control-label">项目编号</label>
                                <div class="col-sm-4">
                                    <input type="text" class="form-control" id="projectNoNew" name="projectNoNew" ng-model="pre.apply.projectNoNew" placeholder="" readonly/>
                                    <input type="hidden" class="form-control" id="projectNo" name="projectNo" ng-model="pre.apply.projectNo" placeholder="" readonly/>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label">投资经理</label>
                                <div class="col-sm-4 has-feedback">
                                    <div class="full-drop">
                                        <input type="text" readonly  class="form-control"  id="investmentManagerName" name="investmentManagerName" ng-model="pre.apply.investmentManager.NAME" >
                                        <input type="hidden"  readonly id="investmentManagerValue" name="investmentManagerValue"  ng-model="pre.apply.investmentManager.VALUE"/>
                                    </div>
                                </div>
                                <label class="col-sm-2 control-label"><span class="required-r">*</span>项目归属单位负责人</label>
                                <div  id="companyHeader-type-box" class="col-sm-4">
                                    <div id="headercompanyHeaderName">
                                        <div ng-click="setDirectiveParam('companyHeader',0)"  data-toggle="modal" data-target="#userRaido-modal"   class="select2-success">
                                            <div id="s2id_projectModel" class="select2-container select2-container-multi form-control ng-untouched ng-valid ng-dirty ng-valid-parse">
                                                <ul class="select2-choices">
                                                    <li class="select2-search-field">
                                                        <div class="full-drop">
                                                            <input id="s2id_autogen2" class="select2-input" type="text" name="companyHeaderName" spellcheck="false" autocapitalize="off" autocorrect="off" autocomplete="off" style="width: 16px;"/>
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" id="companyHeaderName" name="companyHeaderName" ng-model="pre.apply.companyHeader.NAME" value="{{pre.apply.companyHeader.NAME}}" />
                                    <input type="hidden" id="companyHeaderValue" name="companyHeaderValue" ng-model="pre.apply.companyHeader.VALUE"  />
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label"><span class="required-r">*</span>项目名称</label>
                                <div class="col-sm-4">
                                    <input type="text"  data-toggle="modal" data-target="#companyProjectName-modal" class="form-control" id="projectName" name="projectName" ng-model="pre.apply.projectName" value="{{pre.apply.projectNameTZ}}"/>
                                </div>
                                <label class="col-sm-2  control-label">项目所在地</label>
                                <div class="col-sm-4">
                                    <input type="text"  class="form-control" name="projectAddress" ng-model="pre.apply.projectAddress" readonly>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label">业务类型</label>
                                <div id="headeroneservicetypebox"  class="col-sm-4">
                                    <input type="text" class="form-control" value="{{pre.apply.serviceType[0].VALUE}}" readonly/>
                                </div>
                                <label class="col-sm-2 control-label">项目投资总额</label>
                                <div class="col-sm-4">
                                    <input type="text"  class="form-control" name="investMoney" ng-model="pre.apply.investMoney"
                                           onkeyup="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"
                                           onafterpaste="if(this.value.length==1){this.value=this.value.replace(/[^1-9]/g,'')}else{this.value=this.value.replace(/\D/g,'')}"/>
                                    <span class="unit-n">万元</span>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label"><span class="required-r">*</span>投资模式</label>
                                <div class="col-sm-1 noright-pad">
                                    <label class="checkbox-inline">
                                        <input class="px" type="checkbox" ng-model="investmentModel" ng-change="changeInvestmentModel()" id="investmentModel" name="investmentModel"/>
                                        <span class="lbl">PPP</span>
                                    </label>
                                </div>
                                <div id="headerprojectmodebox" class="col-sm-3 noleft-pad">
                                    <div class="select2-success">
                                        <select multiple="multiple" id="projectmodeboxName" name="projectmodeboxName" class="form-control"  ng-model="pre.apply.projectModel"
                                                ng-options="pm.VALUE for pm in dicSyn.projectModelValue track by pm.KEY" ng-change="changeProjectModel()">
                                        </select>
                                    </div>
                                </div>
                                <label class="col-sm-2 control-label">单体项目数</label>
                                <div class="col-sm-4 has-feedback">
                                    <input type="text"  class="form-control" name="projectNum" ng-model="pre.apply.projectNum" placeholder="">
                                    <span class="unit-n">个</span>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label">项目规模</label>
                                <div class="col-sm-4">
                                    <input  class="form-control" name="projectSize" ng-model="pre.apply.projectSize" placeholder=""/>
                                </div>
                                <label class="col-sm-2 control-label">竞争对手</label>
                                <div class="col-sm-4">
                                    <input type="text"  class="form-control" id="competitor" name="competitor" ng-model="pre.apply.competitor" />
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label">拟投标时间</label>
                                <div class="col-sm-4 has-feedback">
                                    <input type="text"  id="tenderTime" name="" value="{{pre.apply.tenderTime}}" ng-model="pre.apply.tenderTime" class="form-control" />
                                    <i class="fa fa-calendar form-control-feedback"></i>
                                    <span id="showdate" ></span>
                                </div>
                                <label class="col-sm-2 control-label">保证金支付时间</label>
                                <div class="col-sm-4 has-feedback">
                                    <input type="text"  id="paymentTime" value="{{pre.apply.paymentTime}}" ng-model="pre.apply.paymentTime" class="form-control" />
                                    <i class="fa fa-calendar form-control-feedback"></i>
                                </div>
                            </div>
                            <div class="row">
                                <label class="col-sm-2 control-label"><span class="required-r">*</span>投资中心/水环境投资中心项目负责人</label>
                                <div class="col-sm-4 has-feedback">
                                    <div id="headerinvestmentPersonName" class="col-sm-6 noleft-pad noright-pad"
                                         style="width: calc(50% - 2.5px);margin-right: 5px">
                                        <div ng-click="setDirectiveParam('investmentPerson',0)"  data-toggle="modal" data-target="#userRaido-modal"  class="select2-success">
                                            <div  class="select2-container select2-container-multi form-control ng-untouched ng-valid ng-dirty ng-valid-parse">
                                                <ul class="select2-choices">
                                                    <li class="select2-search-field">
                                                        <div class="full-drop">
                                                            <input class="select2-input" type="text" name="investmentPersonName" spellcheck="false" autocapitalize="off" autocorrect="off" autocomplete="off" style="width: 16px;" placeholder="区域负责人">
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" id="investmentPersonName" name="investmentPersonName" ng-model="pre.apply.investmentPerson.NAME" value="{{pre.apply.investmentPerson.NAME}}" />
                                    <input type="hidden" id="investmentPersonValue" name="investmentPersonValue" ng-model="pre.apply.investmentPerson.VALUE"  />

                                    <div id="headerdirectPersonName" class="col-sm-6 noleft-pad noright-pad" style="width: calc(50% - 2.5px)">
                                        <div ng-click="setDirectiveParam('directPerson',0)"  data-toggle="modal" data-target="#userRaido-modal"  class="select2-success">
                                            <div  class="select2-container select2-container-multi form-control ng-untouched ng-valid ng-dirty ng-valid-parse">
                                                <ul class="select2-choices">
                                                    <li class="select2-search-field">
                                                        <div class="full-drop">
                                                            <input class="select2-input" type="text" spellcheck="false" name="directPersonName" autocapitalize="off" autocorrect="off" autocomplete="off" style="width: 16px;" placeholder="直接负责人">
                                                        </div>
                                                    </li>
                                                </ul>
                                            </div>
                                        </div>
                                    </div>
                                    <input type="hidden" id="directPersonName" name="directPersonName" ng-model="pre.apply.directPerson.NAME" value="{{pre.apply.directPerson.NAME}}" />
                                    <input type="hidden" id="directPersonValue" name="directPersonValue" ng-model="pre.apply.directPerson.VALUE"  />
                                </div>
                                <label class="col-sm-2 control-label">申请填写日期</label>
                                <div class="col-sm-4 has-feedback">
                                    <input type="text" readonly class="form-control"  id="create_date" name="create_date" ng-model="pre.create_date" />
                                    <i class="fa fa-calendar form-control-feedback"></i>
                                </div>
                            </div>
                        </div>
                        <!--<div class="tab-pane" id="flow_chart">
                            <directive-process-page></directive-process-page>
                        </div>-->
                        <div class="tab-pane" id="flow_chart">
                            <!--<directive-process-page></directive-process-page>-->
                            <directive-process-page-new process-key="preReview"></directive-process-page-new>
                        </div>
                        <div class="tab-pane" id="contracts_resources">
                            <directive-accachment-new id="preInfo" business-type="preReview" page-location="preInfo" business-id="preOracle.BUSINESSID"
                                                      last-update-by="pre.apply.investmentManager" wf-state="preOracle.WF_STATE" file-list="newAttachment"
                                                      init-update="initUpdate(id)" service-type="serviceType" project-model="projectModel"></directive-accachment-new>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="button-group">
            <div class="row">
                <div class="option txl">
                    <a class="btn btn-info" href="#/PreInfoList/0"><i class="fa fa-reply"></i>返回</a>
                    <button ng-if="flag == 1" type="button" ng-click="save()" id="savebtn" class="btn btn-info"><i class="fa fa-save"></i>保存</button>
                    <button ng-if="flag == 2" type="button" ng-click="update()" id="updatebtn" class="btn btn-info"><i class="fa fa-save"></i>保存</button>
                    <button ng-show="preOracle.WF_STATE=='0'" ng-click="showSubmitModal()" id="submitbtn" class="btn btn-info" title=""><i class="fa fa-cloud-upload"></i>提交</button>
                    <div id="submitModal"  class="modal" tabindex="-1" role="dialog" style="display: none;">
                        <pre-review-bpmn-pop-win approve="approve" before-submit="beforeSubmit()"></pre-review-bpmn-pop-win>
                    </div>
                </div>
            </div>
        </div>
    </form>
</div>
<directive-user-list ></directive-user-list>
<directive-user-radio-list></directive-user-radio-list>
<directive-company-list></directive-company-list>

<script type="text/javascript">
    $().ready(function() {
        // validate signup form on keyup and submit
        $("#myFormPre").validate({
            rules: {
                //	personLiable:"required",
                companyHeaderName:"required",
                grassrootsLegalStaffName:"required",
                projectName:"required",
                investmentPersonName:"required",
                directPersonName:"required",
                projectmodeboxName:"required"
            },
            messages: {
                //	personLiable:"此项必填",
                companyHeaderName:"此项必填",
                grassrootsLegalStaffName:"此项必填",
                projectName:"此项必填",
                investmentPersonName:"此项必填",
                directPersonName:"此项必填",
                projectmodeboxName:"此项必填"
            }
        });
    });
    angular.element(document).ready(function() {
        var options = {
            todayBtn: "linked",
            orientation: $('body').hasClass('right-to-left') ? "auto right" : 'auto auto'
        }
        $('#bs-datepicker-edit').datepicker();
        $('#tenderTime').datepicker(options);
        $('#paymentTime').datepicker(options);
        var date = new Date();
        date.setDate(date.getDate());
        var curDate = date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate();
        var tenderOptions = {
            orientation: $('body').hasClass('right-to-left') ? "auto right" : 'auto auto',
            startDate:curDate
        }
        $('#expectedContractDate').datepicker(tenderOptions);
        $("#headeroneservicetypebox select").select2();
        $("#headerprojectmodebox select").select2();
    });
</script>