<link rel="stylesheet" href="../styles/style_preview.css">
<div class="preview-contanier" ng-controller="FormalBiddingInfoPreview">
    <div class="mheader row text-blue-name">
        {{ formalPreview.apply.projectName }}
        <a style="height: 40px" ng-if="flag != 1 && flag != 2 && flag != 3 && flag != 4 && flag != 5 && flag != 6 && flag != 7 && flag != 8" class="btn-return" href="#/FormalBiddingInfo/{{formalPreview.id}}@2/{{formalPreview.url}}/1">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 1" class="btn-return" href="#/waitDecisionReviewList">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 2" class="btn-return" href="#/">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 3" class="btn-return" href="#/todayMeetingManageList/{{'#/'|encodeURI}}">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 4" class="btn-return" href="#/fillMaterialList/0/JTI1MjMlMkY=">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 5" class="btn-return" href="#/fillMaterialList/0/JTI1MjMlMkY=">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 6" class="btn-return" href="#/meeting/MeetingArrangement/0">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 7" class="btn-return" href="#/historyDecisionReviewList/{{'#/FormalBiddingInfoPreview'|encodeURI}}">
            返回
        </a>
        <a style="height: 40px" ng-if="flag == 8" class="btn-return" href="#/MeetingManageList">
            返回
        </a>
    <!--<h5 class="text-gray">评审报告出具时间：{{formalPreview.submit_date}}</h5>-->
        <!--<div align="center">-->
            <!--<a class="btn btn-info" href="#/FormalBiddingInfo/{{formalPreview.id}}@2/{{formalPreview.url}}/1">-->
                <!--<i class="fa fa-reply"></i>返回</a>-->
        <!--</div>-->
        <!--<img src="assets/images/pixel-admin/main-navbar-logo.png" alt="Pixel Admin" class="logo" />-->
    </div>
    <div class="row mtab2 text-gray">
        <a id="processReview" class="chose col-md-3 col-sm-6 col-xs-12">
            项目过程回顾
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="template" class="col-md-3 col-sm-6 col-xs-12">
            风控评审意见汇总
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="formalReport" class="col-md-3 col-sm-6 col-xs-12">
            正式评审报告
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
        <a id="score" class="col-md-3 col-sm-6 col-xs-12">
            项目整体评分
            <div class="line">
						<span class="fcir">
							<span></span>
						</span>
            </div>
        </a>
    </div>
    <!--<div class="row mtab text-gray">
        <a id="processReview" class="chose col-md-3 col-sm-6 col-xs-12">项目过程回顾</a>
        <a id="template" class="col-md-3 col-sm-6 col-xs-12">风控评测意见汇总</a>
        <a id="formalReport" class="col-md-3 col-sm-6 col-xs-12">正式评审报告</a>
        <a id="score" class="col-md-3 col-sm-6 col-xs-12">项目整体评分</a>
    </div>-->
    <div class="mperson">
        <div>评审负责人<em>{{formalPreview.taskallocation.reviewLeader.NAME}}</em></div>
        <div>法律负责人<em>{{formalPreview.taskallocation.legalReviewLeader.NAME}}</em></div>
        <div>投资建议<em>{{formalPreview.investmentType.ITEM_NAME}}</em></div>
        <div>评审难度评级<em>{{ formalPreview.projectRating.name }}</em></div>
        <!--<div class="col-md-3 col-sm-6 col-xs-12">评审负责人<em>{{formalPreview.taskallocation.reviewLeader.NAME}}</em></div>-->
        <!--<div class="col-md-3 col-sm-6 col-xs-12">法律负责人<em>{{formalPreview.taskallocation.legalReviewLeader.NAME}}</em></div>-->
        <!--<div class="col-md-3 col-sm-6 col-xs-12">投资建议<em>{{formalPreview.investmentType.ITEM_NAME}}</em></div>-->
        <!--<div class="col-md-3 col-sm-6 col-xs-12">评审难度评级<em>{{ formalPreview.projectRating.name }}</em></div>-->
    </div>
    <div class="row rowsection out-rowsection">
        <div class="outside-swiper swiper-container">
            <div class="btn-fullscreen"></div>
            <div class="swiper-button-prev out-swiper-button-prev"></div>
            <div class="swiper-button-next out-swiper-button-next"></div>
            <div class="swiper-wrapper">
                <div class="swiper-slide">
                    <div ng-include src="'page/rcm/formalAssessment/forAssesmentPreview/tabPage/processReview.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/rcm/formalAssessment/forAssesmentPreview/tabPage/template.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/rcm/formalAssessment/forAssesmentPreview/tabPage/formalReport.html'"></div>
                </div>
                <div class="swiper-slide">
                    <div ng-include src="'page/rcm/formalAssessment/forAssesmentPreview/tabPage/score.html'"></div>
                </div>

            </div>

        </div>
    </div>
</div>
<script type="text/javascript">
    //dom监听resize事件
    (function($, h, c) {
        var a = $([]), e = $.resize = $.extend($.resize, {}), i, k = "setTimeout", j = "resize", d = j
            + "-special-event", b = "delay", f = "throttleWindow";
        e[b] = 350;
        e[f] = true;
        $.event.special[j] = {
            setup : function() {
                if (!e[f] && this[k]) {
                    return false
                }
                var l = $(this);
                a = a.add(l);
                $.data(this, d, {
                    w : l.width(),
                    h : l.height()
                });
                if (a.length === 1) {
                    g()
                }
            },
            teardown : function() {
                if (!e[f] && this[k]) {
                    return false
                }
                var l = $(this);
                a = a.not(l);
                l.removeData(d);
                if (!a.length) {
                    clearTimeout(i)
                }
            },
            add : function(l) {
                if (!e[f] && this[k]) {
                    return false
                }
                var n;
                function m(s, o, p) {
                    var q = $(this), r = $.data(this, d);
                    r.w = o !== c ? o : q.width();
                    r.h = p !== c ? p : q.height();
                    n.apply(this, arguments)
                }
                if ($.isFunction(l)) {
                    n = l;
                    return m
                } else {
                    n = l.handler;
                    l.handler = m
                }
            }
        };
        function g() {
            i = h[k](function() {
                a.each(function() {
                    var n = $(this), m = n.width(), l = n.height(), o = $
                        .data(this, d);
                    if (m !== o.w || l !== o.h) {
                        n.trigger(j, [ o.w = m, o.h = l ])
                    }
                });
                g()
            }, e[b])
        }
    })(jQuery, this);
</script>
<script>
    $(function() {

        setTimeout(function () {
            var outsideSwiper = new Swiper('.outside-swiper', {
                observer: true,
                observeParents: true,
                loop: false,
                autoHeight: true,
                roundLengrhs: true,
                navigation: {
                    nextEl: '.out-swiper-button-next',
                    prevEl: '.out-swiper-button-prev'
                },
                on: {
                    slideChange: function(){
                        if(this.activeIndex == 1){
                            if(this.previousIndex==0){
                                $('.out-swiper-button-next').hide();
                                $('.son-swiper-button-prev').hide();
                            }else{
                                $('.out-swiper-button-prev').hide();
                                $('.son-swiper-button-next').hide();
                            }

                        }else{
                            $('.out-swiper-button-prev').show()
                            $('.out-swiper-button-next').show()

                        }
                    },
                    transitionStart: function () {
                        var formalBiddingInfoPreview = document.querySelector('[ng-controller = FormalBiddingInfoPreview]');
                        var $scope = angular.element(formalBiddingInfoPreview).scope();
                        $scope.changeStyle(this.activeIndex)
                    }
                }
            });
            $('#processReview').click(function(){
                outsideSwiper.slideTo(0, 1000, true);//切换到第一个slide，速度为1秒
                $('#processReview').addClass('chose');
                $('#template').removeClass('chose');
                $('#formalReport').removeClass('chose');
                $('#score').removeClass('chose');
            });
            $('#template').click(function(){
                outsideSwiper.slideTo(1, 1000, true);//切换到第二个slide，速度为1秒
                $('#template').addClass('chose');
                $('#processReview').removeClass('chose');
                $('#formalReport').removeClass('chose');
                $('#score').removeClass('chose');
            });
            $('#formalReport').click(function(){
                outsideSwiper.slideTo(2, 1000, true);//切换到第三个slide，速度为1秒
                $('#formalReport').addClass('chose');
                $('#template').removeClass('chose');
                $('#processReview').removeClass('chose');
                $('#score').removeClass('chose');
            });
            $('#score').click(function(){
                outsideSwiper.slideTo(3, 1000, true);//切换到第四个slide，速度为1秒
                $('#score').addClass('chose');
                $('#template').removeClass('chose');
                $('#formalReport').removeClass('chose');
                $('#processReview').removeClass('chose');
            });
            $('.btn-fullscreen'). click(function (e) {
                e.stopPropagation()
                if($('.out-rowsection').hasClass('wrap')){
                    $(this).removeClass('btn-outscreen')
                    $('.out-rowsection').removeClass('wrap')
                    $('.outside-swiper').removeClass('current-swiper-scale')
                    $('.swiper-wrapper').removeClass('heightAll').addClass('heightAll2')
                    $('.swiper-slide').removeClass('heightAll').addClass('heightAll2')
                    $('.mcontent').removeClass('heightAll').addClass('heightAll2')
                    $('.mcontent').css('width','83.3%')
                    //$('.content2')
                    $('.current-swiper').removeClass('noPadding')
                    $('.left-swiper').show()
                    $('.right-swiper').show()
                    $('.swiper-pagination').removeClass('widthAll')
                    var maxHeight,wrapHeight;
                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                    $('.mcontent').each(function(){
                        if(!$(this).children('.contentwrap').hasClass('nocover')){
                            maxHeight = $(this).height() - 52
                            wrapHeight = $(this).find('.contentwrap').height()
                            if(wrapHeight == maxHeight){
                                $(this).find('.table-cover').show()
                            }
                        }

                    })
                    /*if ($("#demo-settings-toggler")) {
                        $("#demo-settings-toggler").show();
                    }*/
                }else{
                    $(this).addClass('btn-outscreen')
                    $('.out-rowsection').addClass('wrap')
                    $('.outside-swiper').addClass('current-swiper-scale')
                    $('.swiper-wrapper').removeClass('heightAll2').addClass('heightAll')
                    $('.swiper-slide').removeClass('heightAll2').addClass('heightAll')
                    $('.mcontent').removeClass('heightAll2').addClass('heightAll')
                    $('.mcontent').css('width','100%')
                    $('.current-swiper').addClass('noPadding')
                    $('.left-swiper').hide()
                    $('.right-swiper').hide()
                    $('.swiper-pagination').addClass('widthAll')

                    /*if ($("#demo-settings-toggler")) {
                        $("#demo-settings-toggler").hide();
                    }*/

                    $('.swiper-slide').each(function(){
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                    $('.mcontent').each(function(){
                        var maxHeight = parseFloat($(this).height()*0.95) - 76;
                        var wrapHeight = $(this).find('.contentwrap').height();
                        if(wrapHeight < maxHeight){

                            $(this).find('.table-cover').hide()
                        }
                    })
                }
            })
            $('.outside-swiper').resize(function(){
                outsideSwiper.update()
            })
            $('.table-cover').click(function(){
                $(this).parent('.contentwrap').addClass('nocover')
            })
            /*$('.text-blue-name').click(function (e) {
                e.stopPropagation()
                if ($('.out-rowsection').hasClass('wrap')) {
                    $('.out-rowsection').removeClass('wrap')
                    $('.outside-swiper').removeClass('current-swiper-scale')
                    $('.swiper-wrapper').removeClass('heightAll').addClass('heightAll2')
                    $('.swiper-slide').removeClass('heightAll').addClass('heightAll2')
                    $('.mcontent').removeClass('mcontent2')
                    $('.current-swiper').removeClass('noPadding')
                    $('.left-swiper').show()
                    $('.right-swiper').show()
                } else {
                    $('.out-rowsection').addClass('wrap')
                    $('.outside-swiper').addClass('current-swiper-scale')
                    $('.swiper-wrapper').removeClass('heightAll2').addClass('heightAll')
                    $('.swiper-slide').removeClass('heightAll2').addClass('heightAll')
                    $('.mcontent').addClass('mcontent2')
                    $('.current-swiper').addClass('noPadding')
                    //$('.swiper-slide .mcontent').addClass('heightAll')
                    $('.left-swiper').hide()
                    $('.right-swiper').hide()


                    $('.swiper-slide').each(function () {
                        $(this).width(toeven($(this).width()))
                        $(this).height(toeven($(this).height()))
                    })
                }
            })

            $('.text-blue-out').click(function (e) {
                e.stopPropagation()
                $('.out-rowsection').removeClass('wrap')
                $('.outside-swiper').removeClass('current-swiper-scale')
                $('.swiper-wrapper').removeClass('heightAll').addClass('heightAll2')
                $('.swiper-slide').removeClass('heightAll').addClass('heightAll2')
                $('.mcontent').removeClass('mcontent2')
                $('.current-swiper').removeClass('noPadding')
                $('.left-swiper').show()
            })*/
        }, 1000);
                // alert('双击');
                // if($('.out-rowsection').hasClass('wrap')){
                //     $('.out-rowsection').removeClass('wrap')
                //
                //     $('.outside-swiper').removeClass('current-swiper-scale')
                //     $('.mcontent').removeClass('mcontent2')
                //     $('.swiper-wrapper').removeClass('heightAll')
                //     $('.swiper-slide .mcontent').removeClass('heightAll')
                //     $('.current-swiper').removeClass('noPadding')
                //     $('.left-swiper').show()
                //     $('.right-swiper').show()
                //
                // }else{
                //     $('.out-rowsection').addClass('wrap')
                //     $('.outside-swiper').addClass('current-swiper-scale')
                //     $('.mcontent').addClass('mcontent2')
                //     $('.left-swiper').hide()
                //     $('.right-swiper').hide()
                //     $('.swiper-wrapper').addClass('heightAll')
                //     $('.current-swiper').addClass('noPadding')
                //     $('.swiper-slide .mcontent').addClass('heightAll')
                //     $('.swiper-slide').each(function(){
                //         $(this).width(toeven($(this).width()))
                //         $(this).height(toeven($(this).height()))
                //     })
                // }
                // var height = $('.outside-swiper').height()
                // console.log(height)
                // $('.swiper-wrapper').eq(0).css('height',height+'px!important')
                // console.log($('.swiper-wrapper').eq(0),$('.swiper-wrapper').eq(0).height())


            function toeven(num){
                return num%2 == 0?num:num+1
            }
        //     $('.text-blue-name').click(function (e) {
        //         if($('.out-rowsection').hasClass('wrap')){
        //             $('.out-rowsection').removeClass('wrap')
        //             $('.outside-swiper').removeClass('current-swiper-scale')
        //             $('.mcontent').removeClass('mcontent2')
        //             $('.swiper-wrapper').removeClass('heightAll')
        //             // $('.swiper-slide').removeClass('heightAll')
        //             $('.swiper-slide .mcontent').removeClass('heightAll')
        //             $('.current-swiper').removeClass('noPadding')
        //             $('.left-swiper').show()
        //             $('.right-swiper').show()
        //
        //         }else{
        //             $('.out-rowsection').addClass('wrap')
        //             $('.outside-swiper').addClass('current-swiper-scale')
        //             $('.mcontent').addClass('mcontent2')
        //             $('.left-swiper').hide()
        //             $('.right-swiper').hide()
        //             $('.swiper-wrapper').addClass('heightAll')
        //             $('.current-swiper').addClass('noPadding')
        //             // $('.swiper-slide').addClass('heightAll')
        //             $('.swiper-slide .mcontent').addClass('heightAll')
        //             $('.swiper-slide').each(function(){
        //                 $(this).width(toeven($(this).width()))
        //                 $(this).height(toeven($(this).height()))
        //             })
        //         }
        //     })
        //
        // $('.text-blue-out').click(function (e) {
        //     e.stopPropagation()
        //     $('.out-rowsection').removeClass('wrap')
        //     $('.outside-swiper').removeClass('current-swiper-scale')
        //     $('.mcontent').removeClass('mcontent2')
        //     $('.swiper-wrapper').removeClass('heightAll')
        //     // $('.swiper-slide').removeClass('heightAll')
        //     $('.swiper-slide .mcontent').removeClass('heightAll')
        //     $('.current-swiper').removeClass('noPadding')
        //     $('.left-swiper').show()
        //     $('.right-swiper').show()
        // })
    })
</script>