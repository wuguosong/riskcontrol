<div class="panel-body" >
    <form id="SupplementReport" name="SupplementReport" class="form-horizontal ng-pristing ng-valid">
        <div class="">
            <div class="header detail-page">
                <img src="assets/images/icons/detail.png" width="" height="" alt="" title="" /><span class="hd-title">{{title}}</span>
            </div>
            <div class="panel-group" id="formalReviewReport">
                <div class="panel">
                    <div id="flag1-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#formalReviewReport" href="/#originalReview">
                            <span class="text">1.原评审回顾<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <div id="originalReview" class="panel-collapse collapse">
                        <div class="panel-body">
                            <div class="row">
                                <label class="col-sm-2 control-label">项目名称</label>
                                <div class="col-sm-10 noright-pad">
                                    <input type="text" readonly ng-model="formalReport.projectName" class="form-control" id="projectName" name="projectName"/>
                                </div>
                            </div>
                            <div class="row">
                                <div class="table-responsive">
                                    <table border="0" cellspacing="0" cellpadding="0" class="table table-bordered table-text-mid table-light table-hd-center">
                                        <thead>
                                        <tr>
                                            <th width="15%">分类</th>
                                            <th>主要内容</th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <td>原评审时间<span ng-if="actionparm!='View'" class="required-r">*</span></td>
                                            <td><input type="text" ng-model="formalReport.originalReviewTime" name="originalReviewTime" id="originalReviewTime" class="form-control" /></td>
                                        </tr>
                                        <tr>
                                            <td>原评审结论<span ng-if="actionparm!='View'" class="required-r">*</span></td>
                                            <td><input type="text" ng-model="formalReport.originalAppraisalConclusion" name="originalAppraisalConclusion" id="originalAppraisalConclusion" class="form-control" /></td>
                                        </tr>
                                        <tr>
                                            <td>原评审项目信息<span ng-if="actionparm!='View'" class="required-r">*</span></td>
                                            <td><input type="text" ng-model="formalReport.originalReviewProjectInformation" name="originalReviewProjectInformation" id="originalReviewProjectInformation" class="form-control" /></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div> <!-- / .panel-body -->
                    </div> <!-- / .collapse -->
                </div>
                <div class="panel">
                    <div id="flag2-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#formalReviewReport" href="/#adjustmentAnalysis">
                            <span class="text">2.重要调整及原因分析<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <div id="adjustmentAnalysis" class="panel-collapse collapse">
                        <div class="panel-body">
                            <div class="row"><textarea name="" ng-model="formalReport.mainReason"  rows="1" cols="1" class="form-control" auto-height></textarea></div>
                            <div class="row">
                                <div class="txl">
                                    <button  type="button" class="btn btn-info" ng-click="addAdjustment()"><i class="glyphicon glyphicon-plus"></i>新增</button>
                                    <button  type="button" class="btn btn-info" ng-click="commonDdelete(10)"><i class="glyphicon glyphicon-trash"></i>删除</button>
                                </div>
                            </div>
                            <div class="row" id="adjustment">
                                <div class="table-responsive">
                                    <table border="0" cellspacing="0" cellpadding="0" class="table table-bordered  table-text-mid table-light table-hd-center">
                                        <thead>
                                        <tr>
                                            <th>选择</th>
                                            <th>调整指标</th>
                                            <th colspan="2">主要内容</th>
                                            <th>调整原因</th>
                                        </tr>
                                        </thead>
                                        <tbody  ng-repeat="c in formalReport.adjustmentAnalysis track by $index">
                                        <tr>
                                            <td rowspan="2" class="txc">
                                                <label class="checkbox-inline">
                                                    <input ng-disabled="actionparm=='View'" type="checkbox" class="px" ng-model="c.selected"/>
                                                    <span class="lbl">&nbsp;</span>
                                                </label>
                                            </td>
                                            <td rowspan="2"><input type="text" name="" ng-model="c.adjustTargets" class="form-control" /></td>
                                            <td>原评审</td>
                                            <td><input type="text" name="" ng-model="c.oldReview" class="form-control" /></td>
                                            <td rowspan="2"><textarea name="" rows="" ng-model="c.jumpingReason" cols="" class="form-control" auto-height></textarea></td>
                                        </tr>
                                        <tr>
                                            <td>调整后</td>
                                            <td><input type="text" name="" ng-model="c.afterReview" class="form-control" /></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel">
                    <div id="flag3-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#formalReviewReport" href="/#incomeEvaluation"><span class="text">3.收益评估<i class="i-triangle"></i></span></a>
                    </div>
                    <div id="incomeEvaluation" class="panel-collapse collapse">
                        <div class="panel-body">
                            <div class="row">
                                <textarea name="" rows="1" ng-model="formalReport.borderCondition" cols="1" class="form-control" auto-height></textarea>
                            </div>
                            <div class="row">
                                <div class="table-light">
                                    <div class="table-header">
                                        <div class="table-caption">项目各项财务指标表</div>
                                    </div>
                                    <div class="table-responsive">
                                        <table border="0" cellspacing="0" cellpadding="0" class="table table-bordered table-text-mid table-light table-hd-center">
                                            <thead>
                                            <tr>
                                                <th>指标分类</th>
                                                <th>指标名称</th>
                                                <th>原评审</th>
                                                <th>调整后</th>
                                                <th>指标变化情况</th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <tr>
                                                <td rowspan="3">投资指标</td>
                                                <td>全投资内部收益率IRR</td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.inerIncomeInvestmentIRR1" name="" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.inerIncomeInvestmentIRR2" name="" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td><input type="text" name="" ng-model="formalReport.inerIncomeInvestmentIRR3" class="form-control" /></td>
                                            </tr>
                                            <tr>
                                                <td>自有资金内部收益率IRR</td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.ownIncomeInvestmentIRR1"  name="" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.ownIncomeInvestmentIRR2" name="" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td><input type="text" name="" ng-model="formalReport.ownIncomeInvestmentIRR3" class="form-control" /></td>
                                            </tr>
                                            <tr>
                                                <td>全投资静态回收期</td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.staticIncomeInvestment1"name="" class="form-control" />
                                                        <span class="percent">年</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" ng-model="formalReport.staticIncomeInvestment2"name="" class="form-control" />
                                                        <span class="percent">年</span>
                                                    </div>
                                                </td>
                                                <td><input type="text" ng-model="formalReport.staticIncomeInvestment3"name="" class="form-control" /></td>
                                            </tr>
                                            <tr>
                                                <td rowspan="2">财务指标</td>
                                                <td>运营期平均ROE</td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" name="" ng-model="formalReport.averageROE1" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" name="" ng-model="formalReport.averageROE2" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td><input type="text" name="" ng-model="formalReport.averageROE3" class="form-control" /></td>
                                            </tr>
                                            <tr>
                                                <td>运营期平均ROI</td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" name="" ng-model="formalReport.averageROI1" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td>
                                                    <div class="has-feedback">
                                                        <input type="text" name="" ng-model="formalReport.averageROI2" class="form-control" />
                                                        <span class="percent">%</span>
                                                    </div>
                                                </td>
                                                <td><input type="text" name="" ng-model="formalReport.averageROI3" class="form-control" /></td>
                                            </tr>
                                            <tr>
                                                <td>现金流指标</td>
                                                <td>自有资金前五年现金净流量</td>
                                                <td><input type="text" name="" ng-model="formalReport.ownCashFlow1" class="form-control" /></td>
                                                <td><input type="text" name="" ng-model="formalReport.ownCashFlow2" class="form-control" /></td>
                                                <td><input type="text" name="" ng-model="formalReport.ownCashFlow3" class="form-control" /></td>
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel">
                    <div id="flag4-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#preReviewReport" href="/#issuesSummary">
                            <span class="text">4.风险及问题总结<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <directive-formal-report-fxjwtzj></directive-formal-report-fxjwtzj><!-- / .collapse -->
                </div> <!-- / .panel -->
                <div class="panel">
                    <div id="flag5-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#preReviewReport" href="/#potentialSpace">
                            <span class="text">5.挖潜空间<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <div id="potentialSpace" class="panel-collapse collapse followPoints">
                        <div class="panel-body">
                            <div class="row">
                                <textarea name="" ng-model="formalReport.potentialSpace" rows="" cols="" class="form-control" placeholder="内容说明：此处应填写可量化的挖潜空间" auto-height></textarea>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="panel">
                    <div id="flag6-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#preReviewReport" href="/#conclusionSuggest">
                            <span class="text">6.结论与建议<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <directive-formal-report-jlyjy></directive-formal-report-jlyjy>
                </div>
                <div class="panel">
                    <div id="flag7-c" class="panel-heading">
                        <a class="accordion-toggle collapsed" data-toggle="collapse" data-parent="#preReviewReport" href="/#followRequire">
                            <span class="text">7.后续执行要求<i class="i-triangle"></i></span>
                        </a>
                    </div> <!-- / .panel-heading -->
                    <directive-formal-report-hxzxyq></directive-formal-report-hxzxyq>
                </div>
            </div>
        </div>
        <div class="button-group">
            <div class="row">
                <div class="btn-group-gap">
                    <!--<directive-return-btn url="{{oldUrl}}"></directive-return-btn>-->
                    <button class="btn btn-info" type="button"  id="viewlbtn" ng-click="cancel()">返回</button>
                    <!-- <a class="btn btn-info" ng-if="flag=='1'" href="#/ProjectFormalReviewView/Approve/{{reportReturnId}}"><i class="fa fa-reply"></i>返回</a>
                    <a class="btn btn-info" ng-if="flag=='2'" href="#/FormalReportList_new/0"><i class="fa fa-reply"></i>返回</a>
                    <a class="btn btn-info" ng-if="flag=='3'" href="#/FormalBiddingInfoList/0"><i class="fa fa-reply"></i>返回</a>
                    <a class="btn btn-info" ng-if="flag=='4'" href="#/FormalBiddingInfoList/1"><i class="fa fa-reply"></i>返回</a> -->
                    <button type="button" ng-click="saveReport6()" class="btn btn-info" id="savebtn"><i class="fa fa-save"></i>保存</button>
                    <div class="inline-div">
                        <button type="button" ng-if="tabIndex=='0'" class="btn btn-info"  id="submitbnt" ng-click="showSubmitModal()"><i class="fa fa-cloud-upload"></i>提交</button>
                        <div  id="passModal"  class="modal" tabindex="-1" role="dialog" style="display: none;">
                            <directive-need-meeting></directive-need-meeting>
                        </div>
                    </div>
                    <button type="button" id="wordbtn" ng-click="createWord(formalReport._id)" class="btn btn-info"><i class="fa fa-file-o"></i>生成Word文档</button>
                </div>
            </div>
        </div>
    </form>
</div>
<script type="text/javascript">
    <!--
    $(function(){
        //二级菜单关闭&展示
        $(".dropdown-list").children("li").click(function(){
            var dropDown = $(this).find(".sub-list");
            var togClass=$(this).find(".ico");
            $(".dropdown-list li .sub-list").not(dropDown).slideUp(300);
            $(".dropdown-list li .ico").not(togClass).removeClass("fa-minus");
            dropDown.slideToggle(300);
            togClass.toggleClass("fa-minus");
        });
        $('#originalReview').collapse('show');
        $('#adjustmentAnalysis').collapse('show');
        $('#incomeEvaluation').collapse('show');
        $('#issuesSummary').collapse('show');
        $('#potentialSpace').collapse('show');
        $('#conclusionSuggest').collapse('show');
        $('#followRequire').collapse('show');
        $('#estimatedCost').collapse('show');
        $('#preSaleWater').collapse('show');
        $('#proReviewCom').collapse('show');
        $('#followPoints').collapse({toggle: false});
        //模拟select功能
        $(".full-drop").click(function(){
            $(this).find(".drop-menu").fadeIn(300);
            $(".drop-menu").not($(this).children('.drop-menu')).fadeOut(300);
            $(".drop-menu .sub-list li").find("a").click(function(){
                var inputVaule=$(this).parents(".drop-menu").siblings(".form-control");
                var aTxet=$(this).children("a").text();
                var likeSelect=$(this).parents(".drop-menu");
                if (likeSelect.hasClass("choice-more")){
                    return false;
                }else{
                    inputVaule.attr("value",aTxet)
                    likeSelect.fadeOut(300);
                    return false;
                }
            });
            return false;
        });
        $(".drop-menu .sub-list li").find("a").click(function(){
            $(this).toggleClass("cur");
        });
        $("body").click(function(){
            $(".full-drop").find(".drop-menu").fadeOut(300);
        });

        $("input[name='input-way']").click(function(){
            var wayValue=$("input[name='input-way']:checked").val();
            if(wayValue==1){
                $("input[name='preAssessmentScale']").css({"display":"block"});
                $("#unit").css({"display":"block"});
                $("textarea[name='preAssessmentScale']").css({"display":"none"});
            }else{
                $("#unit").parent().removeClass("has-feedback");
                $("input[name='preAssessmentScale']").css({"display":"none"});
                $("#unit").css({"display":"none"});
                $("textarea[name='preAssessmentScale']").css({"display":"block"});
            }
        });

    });

    angular.element(document).ready(function() {
        var options = {
            todayBtn: "linked",
            orientation: $('body').hasClass('right-to-left') ? "auto right" : 'auto auto'
        }
        $('#tenderTime').datepicker(options);
        $('#paymentTime').datepicker(options);
        $('ul.bs-tabdrop').tabdrop();

        $('#switcher-left').switcher({
            theme: 'square',
            on_state_content: '<span class="fa fa-check"></span>',
            off_state_content: '<span class="fa fa-times"></span>'
        });
        $('#switcher-right').switcher({
            theme: 'square',
            on_state_content: '<span class="fa fa-check"></span>',
            off_state_content: '<span class="fa fa-times"></span>'
        });
    });
    //-->
    $().ready(function() {
        // validate signup form on keyup and submit
        $("#SupplementReport").validate({
            rules: {
                //	personLiable:"required",
                originalReviewTime:"required",
                originalAppraisalConclusion:"required",
                originalReviewProjectInformation:"required"
            },
            messages: {
                //	personLiable:"此项必填",
                originalReviewTime:"此项必填",
                originalAppraisalConclusion:"此项必填",
                originalReviewProjectInformation:"此项必填"
            }
        });
    });
</script>

<div class="side-catalog">
    <div class="side-bar">
        <i class="circle start"></i>
        <i class="circle end"></i>
    </div>
    <div class="catalog-scroller">
        <ul class="catalog-list">
            <li id="flag1" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">1</span>
						<span class="title-link">原评审回顾</span>
					</span>
                </a>
            </li>
            <li id="flag2" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">2</span>
						<span class="title-link">重要调整及原因分析</span>
					</span>
                </a>
            </li>
            <li id="flag3" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">3</span>
						<span class="title-link">收益评估</span>
					</span>
                </a>
            </li>
            <li id="flag4" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">4</span>
						<span class="title-link">风险及问题总结</span>
					</span>
                </a>
            </li>
            <li id="flag5" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">5</span>
						<span class="title-link">挖潜空间</span>
					</span>
                </a>
            </li>
            <li id="flag6" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">6</span>
						<span class="title-link">结论与建议</span>
					</span>
                </a>
            </li>
            <li id="flag7" class="catalog-title">
                <i class="pointer"></i>
                <a class="title-link" href="javascript:void(0);">
					<span class="text">
						<span class="title-index">7</span>
						<span class="title-link">后续执行要求</span>
					</span>
                </a>
            </li>
        </ul>
        <!--<a class="arrow" href="javascript:void(0);"><img alt="arrow" width="21" height="15" src="assets/images/icons/arrow.png"/></a>-->
    </div>
    <div class="bottom-wrap">
        <a class="toggle-button" href="javascript:void(0);"><i class="fa fa-list-ul"></i></a>
        <a class="gotop-button" href="javascript:window.scrollTo( 0, 0 );"><i class="fa fa-chevron-up"></i></a>
    </div>
</div>
<script>
    $(function(){
        //侧边目录
        $(window).scroll(function(){
            var menuBottom = $(".offset-flag").offset().top;
            if($(window).scrollTop()>=menuBottom){
                $(".side-catalog").css("display","block");
            }
            else{
                $(".side-catalog").css("display","none");
            };
        });
        //显示隐藏侧边目录
        $(".toggle-button").click(function(){
            $(".side-catalog").toggleClass("collapse");
        });
        //点击目录跳到相应模块
        $(".catalog-list li").click(function(){
            $(this).addClass("cur").siblings("li").removeClass("cur");
            var _id = $(this).attr("id");
            if(typeof $('#'+_id+'-c').offset() !== 'undefined'){
                var _idTop = $("#"+_id+"-c").offset().top-10;
                $("html,body").animate({"scrollTop":_idTop},300);
            }
        });
        //滚动响应
        if (typeof(SideCatalog) == "undefined" || !SideCatalog) {
            var SideCatalog= {};
        };
        SideCatalog.catalogDetail = (function(){
            // scroll to tab content
            var _gotoTab = function(){
                window.onscroll= function(){
                    SideCatalog.ids = [];
                    $('.catalog-list li').each(function(){
                        var id = $(this).attr('id');
                        if(typeof $('#'+id+'-c').offset() !== 'undefined')
                        {
                            SideCatalog[id] = $('#'+id+'-c').offset().top-11;
                        }
                        SideCatalog.ids.push(id);
                    });
                    var _top = $(document).scrollTop();
                    //循环ID处理屏幕滚动情况
                    $.each(SideCatalog.ids,function(key,id){
                        var next_id = key+1;
                        var next_tab = SideCatalog.ids[next_id];
                        if(( _top >= SideCatalog[id] && _top <= SideCatalog[next_tab]) || _top >= SideCatalog[id])
                        {
                            $('#'+id).addClass('cur').siblings("li").removeClass("cur");
                        }
                    });
                };
            };
            function _init(){
                _gotoTab();
            }
            return {
                init: _init
            }
        })();
        $(document).ready(function() {
            SideCatalog.catalogDetail.init();
        });
        //查看页面不可编辑
        var href=window.location.href;
        if(href.indexOf("/View/")>0){
            $('#content-wrapper input').attr("readonly","readonly");
            $('textarea').attr("readonly","readonly");
            $('select').attr("disabled","disabled");
        }
    });
</script>